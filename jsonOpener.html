<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Title</title>
  <script src="http://cdn.babylonjs.com/babylon.max.js"></script>
  <script src="https://cdn.babylonjs.com/gui/babylon.gui.min.js"></script>
  <script src="meshloader.js"></script>
  <script src="hands.js"></script>
  <script src="leapdataset.js"></script>
  <style>
    #canvas {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <canvas id="canvas"></canvas>
  <script>
    window.addEventListener('DOMContentLoaded', function() {


      var canvas = document.getElementById('canvas');
      var engine = new BABYLON.Engine(canvas, true);
      var scene;
      var createScene = function() {
        console.log("createScene");
        scene = new BABYLON.Scene(engine);
        createCamera();
        dataset = data();
        var hand = drawHand(scene, dataset[0]);

        var light = new BABYLON.DirectionalLight("dir01", new BABYLON.Vector3(-0, -1, -1.0), scene);
        light.position = new BABYLON.Vector3(50, 250, 200);
        light.shadowOrthoScale = 2.0;

        scene.registerBeforeRender(function () {
          drawAnimation(scene, hand, dataset);
        })
        return scene;
      }
      var createCamera = function() {
        var j = [0, 21, 0]
        if (navigator.getVRDisplays) {
          camera = new BABYLON.WebVRFreeCamera("WebVRCamera", new BABYLON.Vector3(140, 50, -20), scene);
        } else {
          camera = new BABYLON.VRDeviceOrientationFreeCamera("WebVRCamera", new BABYLON.Vector3(170, 50, -20), scene);
        }
        camera.setTarget(new BABYLON.Vector3(j[0], j[1], j[2]))

        camera.attachControl(canvas, true);
      }
      scene = createScene();
      engine.runRenderLoop(function() {
        scene.render();
      });
    });
  </script>
</body>

</html>
